# ğŸ“˜ Meta.json è¿ç§»æŒ‡å—

> ä»åŸºç¡€ç‰ˆæœ¬è¿ç§»åˆ°å¢å¼ºç‰ˆæ™ºèƒ½æ–‡æ¡£ç³»ç»Ÿ

---

## ğŸ¯ è¿ç§»ç›®æ ‡

å°†ç°æœ‰çš„ `meta.json` æ–‡ä»¶å‡çº§åˆ°å¢å¼ºç‰ˆæ ¼å¼ï¼Œæ”¯æŒï¼š
- âœ… ç²¾ç¡®çš„ä»£ç è¡Œå·å¼•ç”¨
- âœ… ä»£ç å˜æ›´å“ˆå¸Œè¿½è¸ª
- âœ… æ–‡æ¡£äº¤å‰å¼•ç”¨ç³»ç»Ÿ
- âœ… AI ç†è§£å…ƒæ•°æ®
- âœ… è‡ªåŠ¨åŒ–å˜æ›´è¿½è¸ª

---

## ğŸ“‹ è¿ç§»æ­¥éª¤

### ç¬¬ 1 æ­¥ï¼šå®‰è£…ä¾èµ–

```bash
# å®‰è£…éªŒè¯å·¥å…·æ‰€éœ€ä¾èµ–
npm install

# æˆ–æ‰‹åŠ¨å®‰è£…
npm install --save-dev ajv ajv-formats
```

### ç¬¬ 2 æ­¥ï¼šç†è§£æ–°çš„ Schema ç»“æ„

#### ğŸ†• æ–°å¢å­—æ®µ

**1. `code_references` - ä»£ç å¼•ç”¨åˆ—è¡¨**

ç²¾ç¡®å®šä½åˆ°ä»£ç è¡Œå·ï¼Œæ”¯æŒå˜æ›´æ£€æµ‹ï¼š

```json
{
  "code_references": [
    {
      "file": "js/data.worker.js",           // ç›¸å¯¹è·¯å¾„
      "lines": "119-145",                     // è¡Œå·èŒƒå›´
      "label": "CSVè§£æä¸»é€»è¾‘ - parseCSV",    // è¯­ä¹‰æ ‡ç­¾
      "hash": "b4c8d9e2",                     // ä»£ç å“ˆå¸Œï¼ˆ8ä½ï¼‰
      "last_verified": "2025-12-23",         // æœ€åéªŒè¯æ—¥æœŸ
      "critical": true                        // æ˜¯å¦ä¸ºå…³é”®ä»£ç 
    }
  ]
}
```

**2. `doc_references` - æ–‡æ¡£äº¤å‰å¼•ç”¨**

å»ºç«‹åŠŸèƒ½é—´çš„ä¾èµ–å…³ç³»ï¼š

```json
{
  "doc_references": [
    {
      "type": "depends_on",                  // å…³ç³»ç±»å‹
      "doc_id": "F002",                      // ç›®æ ‡æ–‡æ¡£ ID
      "reason": "è§£æåçš„æ•°æ®éœ€è¦é€šè¿‡ä¸šåŠ¡ç±»å‹æ˜ å°„æ¨¡å—è¿›è¡Œæ ‡å‡†åŒ–",
      "bidirectional": true,                 // åŒå‘å¼•ç”¨
      "strength": "strong"                   // ä¾èµ–å¼ºåº¦
    }
  ]
}
```

**å…³ç³»ç±»å‹è¯´æ˜**:
- `depends_on`: ä¾èµ–å…³ç³»ï¼ˆA ä¾èµ– Bï¼‰
- `implements`: å®ç°å…³ç³»ï¼ˆA å®ç° B çš„è®¾è®¡ï¼‰
- `references`: å¼•ç”¨å…³ç³»ï¼ˆA å¼•ç”¨ Bï¼‰
- `extends`: æ‰©å±•å…³ç³»ï¼ˆA æ‰©å±• Bï¼‰
- `conflicts_with`: å†²çªå…³ç³»ï¼ˆA ä¸ B å†²çªï¼‰
- `replaces`: æ›¿ä»£å…³ç³»ï¼ˆA æ›¿ä»£ Bï¼‰

**3. `ai_metadata` - AI ç†è§£å…ƒæ•°æ®**

å¸®åŠ© AI å·¥å…·å¿«é€Ÿç†è§£ä»£ç ï¼š

```json
{
  "ai_metadata": {
    "domain": "æ•°æ®å¤„ç†",                   // ä¸šåŠ¡åŸŸ
    "complexity": "medium",                 // å¤æ‚åº¦
    "key_concepts": [                       // å…³é”®æ¦‚å¿µ
      "Web Worker å¼‚æ­¥å¤„ç†",
      "å¤§æ–‡ä»¶æµå¼å¤„ç†"
    ],
    "entry_points": [                       // å…¥å£å‡½æ•°
      "parseFile",
      "parseCSV"
    ],
    "output_contracts": {                   // è¾“å‡ºå¥‘çº¦
      "parseFile": {
        "returns": "void",
        "description": "å¼‚æ­¥è§£ææ–‡ä»¶ï¼Œé€šè¿‡ postMessage å‘é€ç»“æœ"
      }
    },
    "common_issues": [                      // å¸¸è§é—®é¢˜
      "CSV æ–‡ä»¶åŒ…å« BOM å­—ç¬¦å¯¼è‡´é¦–åˆ—å­—æ®µåé”™è¯¯"
    ]
  }
}
```

**4. `change_tracking` - å˜æ›´è¿½è¸ª**

è‡ªåŠ¨åŒ–åŒæ­¥çŠ¶æ€ç®¡ç†ï¼š

```json
{
  "change_tracking": {
    "last_code_change": "2025-12-16",      // æœ€åä»£ç å˜æ›´
    "last_doc_sync": "2025-12-23",         // æœ€åæ–‡æ¡£åŒæ­¥
    "sync_status": "synced",               // åŒæ­¥çŠ¶æ€
    "pending_updates": [],                 // å¾…æ›´æ–°å†…å®¹
    "auto_sync_enabled": true              // è‡ªåŠ¨åŒæ­¥å¼€å…³
  }
}
```

### ç¬¬ 3 æ­¥ï¼šé€‰æ‹©è¿ç§»ç­–ç•¥

#### **ç­–ç•¥ Aï¼šæ¸è¿›å¼è¿ç§»ï¼ˆæ¨èï¼‰**

ä¼˜å…ˆè¿ç§»æ ¸å¿ƒåŠŸèƒ½æ¨¡å—ï¼Œé€æ­¥æ‰©å±•ï¼š

```bash
# 1. å…ˆè¿ç§» 3 ä¸ªæ ¸å¿ƒæ¨¡å—
å¼€å‘æ–‡æ¡£/01_features/
â”œâ”€â”€ F001_csv_parsing/          â† å…ˆè¿ç§»
â”œâ”€â”€ F006_static_deployment/    â† å…ˆè¿ç§»
â””â”€â”€ F008_dashboard_visualization/  â† å…ˆè¿ç§»

# 2. éªŒè¯æ•ˆæœ
npm run validate-meta F001

# 3. é€æ­¥æ‰©å±•åˆ°å…¶ä»–æ¨¡å—
```

#### **ç­–ç•¥ Bï¼šå…¨é‡è¿ç§»**

ä¸€æ¬¡æ€§è¿ç§»æ‰€æœ‰æ¨¡å—ï¼ˆé€‚åˆå°å‹é¡¹ç›®ï¼‰ï¼š

```bash
# æ‰¹é‡æ›´æ–°æ‰€æœ‰ meta.json
for dir in å¼€å‘æ–‡æ¡£/01_features/F*/; do
  # æ‰‹åŠ¨ç¼–è¾‘æˆ–ä½¿ç”¨è„šæœ¬
  vim "${dir}meta.json"
done
```

### ç¬¬ 4 æ­¥ï¼šå®é™…è¿ç§»ç¤ºä¾‹

ä»¥ **F001_csv_parsing** ä¸ºä¾‹ï¼š

#### **è¿ç§»å‰ï¼ˆåŸºç¡€ç‰ˆï¼‰**

```json
{
  "id": "F001",
  "name": "å¤šæºæ•°æ®æ‘„å…¥ä¸è§£æ",
  "status": "implemented",
  "core_files": ["js/data.worker.js"],
  "tags": ["æ•°æ®å¤„ç†", "CSVè§£æ"],
  "dependencies": ["F002"]
}
```

#### **è¿ç§»åï¼ˆå¢å¼ºç‰ˆï¼‰**

å‚è€ƒå·²æ›´æ–°çš„ `å¼€å‘æ–‡æ¡£/01_features/F001_csv_parsing/meta.json`

#### **è¿ç§»æ­¥éª¤**

1. **æ·»åŠ  `code_references`**

   æ‰“å¼€ä»£ç æ–‡ä»¶ï¼Œå®šä½å…³é”®å‡½æ•°ï¼š

   ```bash
   # æŸ¥æ‰¾å‡½æ•°å®šä¹‰
   grep -n "function parseCSV" js/data.worker.js
   # è¾“å‡º: 119:function parseCSV(file) {
   ```

   æ·»åŠ å¼•ç”¨ï¼š
   ```json
   {
     "file": "js/data.worker.js",
     "lines": "119-145",
     "label": "CSVè§£æä¸»é€»è¾‘ - parseCSV",
     "hash": "å¾…ç”Ÿæˆ",
     "last_verified": "2025-12-23",
     "critical": true
   }
   ```

2. **è®¡ç®—ä»£ç å“ˆå¸Œ**

   ä½¿ç”¨å·¥å…·ç”Ÿæˆï¼ˆç¨åä¼šæä¾›è‡ªåŠ¨åŒ–å·¥å…·ï¼‰ï¼š
   ```bash
   # å°†æ¥ä¼šæä¾›: node tools/update-hashes.js F001
   ```

3. **æ·»åŠ  `doc_references`**

   åˆ†æåŠŸèƒ½ä¾èµ–å…³ç³»ï¼š
   ```json
   {
     "type": "depends_on",
     "doc_id": "F002",
     "reason": "éœ€è¦ä¸šåŠ¡ç±»å‹æ˜ å°„",
     "bidirectional": true,
     "strength": "strong"
   }
   ```

4. **è¡¥å…… `ai_metadata`**

   åŸºäºä»£ç æ€»ç»“å…³é”®ä¿¡æ¯ï¼š
   ```json
   {
     "domain": "æ•°æ®å¤„ç†",
     "complexity": "medium",
     "key_concepts": ["Web Worker", "CSVè§£æ"],
     "entry_points": ["parseFile", "parseCSV"]
   }
   ```

5. **åˆå§‹åŒ– `change_tracking`**

   ```json
   {
     "last_code_change": "2025-12-16",  // æŸ¥çœ‹ git log
     "last_doc_sync": "2025-12-23",     // å½“å‰æ—¥æœŸ
     "sync_status": "synced",
     "pending_updates": [],
     "auto_sync_enabled": true
   }
   ```

### ç¬¬ 5 æ­¥ï¼šéªŒè¯è¿ç§»ç»“æœ

```bash
# éªŒè¯å•ä¸ªæ¨¡å—
npm run validate-meta F001

# éªŒè¯æ‰€æœ‰æ¨¡å—
npm run validate-meta

# é¢„æœŸè¾“å‡º
âœ… [F001] éªŒè¯é€šè¿‡
  âœ… Schema éªŒè¯é€šè¿‡
  âœ… ä»£ç å¼•ç”¨ #1: æ–‡ä»¶æ ¼å¼åˆ†å‘å™¨ - parseFile (js/data.worker.js)
  âœ… ä»£ç å¼•ç”¨ #2: CSVè§£æä¸»é€»è¾‘ - parseCSV (js/data.worker.js)
  âœ… æ–‡æ¡£å¼•ç”¨ #1: depends_on â†’ F002
```

### ç¬¬ 6 æ­¥ï¼šå¤„ç†éªŒè¯é”™è¯¯

#### **å¸¸è§é”™è¯¯ 1ï¼šä»£ç æ–‡ä»¶ä¸å­˜åœ¨**

```
âŒ ä»£ç å¼•ç”¨ #1: æ–‡ä»¶ä¸å­˜åœ¨ - js/data.worker.js
```

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥æ–‡ä»¶è·¯å¾„æ˜¯å¦æ­£ç¡®ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰

#### **å¸¸è§é”™è¯¯ 2ï¼šå“ˆå¸Œä¸åŒ¹é…**

```
âŒ ä»£ç å¼•ç”¨ #1: å“ˆå¸Œä¸åŒ¹é… (ä»£ç å·²å˜æ›´)
   é¢„æœŸ: b4c8d9e2
   å®é™…: c5a9f3d1
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. æ£€æŸ¥ä»£ç æ˜¯å¦ç¡®å®å˜æ›´
2. å¦‚æœå˜æ›´åˆç†ï¼Œæ›´æ–°æ–‡æ¡£å¹¶é‡æ–°ç”Ÿæˆå“ˆå¸Œ
3. è¿è¡Œ `node tools/update-hashes.js F001`ï¼ˆå³å°†æä¾›ï¼‰

#### **å¸¸è§é”™è¯¯ 3ï¼šæ–‡æ¡£å¼•ç”¨ä¸å­˜åœ¨**

```
âŒ æ–‡æ¡£å¼•ç”¨ #1: ç›®æ ‡æ–‡æ¡£ä¸å­˜åœ¨ - F999
```

**è§£å†³æ–¹æ¡ˆ**ï¼šæ£€æŸ¥ç›®æ ‡åŠŸèƒ½ ID æ˜¯å¦æ­£ç¡®

#### **å¸¸è§é”™è¯¯ 4ï¼šåŒå‘å¼•ç”¨ç¼ºå¤±**

```
âš ï¸ åŒå‘å¼•ç”¨ç¼ºå¤±: F002 æœªå¼•ç”¨å› F001
```

**è§£å†³æ–¹æ¡ˆ**ï¼šåœ¨ F002 çš„ meta.json ä¸­æ·»åŠ åå‘å¼•ç”¨

---

## ğŸ› ï¸ è¿ç§»è¾…åŠ©å·¥å…·

### å³å°†æä¾›çš„å·¥å…·

**1. `tools/update-hashes.js`** - è‡ªåŠ¨æ›´æ–°ä»£ç å“ˆå¸Œ

```bash
# æ›´æ–°å•ä¸ªæ¨¡å—çš„å“ˆå¸Œ
node tools/update-hashes.js F001

# æ›´æ–°æ‰€æœ‰æ¨¡å—çš„å“ˆå¸Œ
node tools/update-hashes.js --all
```

**2. `tools/migrate-meta.js`** - æ‰¹é‡è¿ç§»åŠ©æ‰‹

```bash
# äº¤äº’å¼è¿ç§»å‘å¯¼
node tools/migrate-meta.js F001

# æ‰¹é‡è¿ç§»
node tools/migrate-meta.js --all
```

**3. `tools/link-tracker.js`** - é“¾æ¥è¿½è¸ªå·¥å…·

```bash
# ç”ŸæˆçŸ¥è¯†å›¾è°±
node tools/link-tracker.js --graph

# éªŒè¯æ‰€æœ‰é“¾æ¥
node tools/link-tracker.js --validate
```

---

## ğŸ“Š è¿ç§»æ£€æŸ¥æ¸…å•

ä½¿ç”¨æ­¤æ¸…å•ç¡®ä¿è¿ç§»å®Œæ•´ï¼š

```markdown
- [ ] å®‰è£…ä¾èµ– (npm install)
- [ ] æ·»åŠ  code_referencesï¼ˆè‡³å°‘ 2-3 ä¸ªå…³é”®ä»£ç å—ï¼‰
- [ ] è®¡ç®—å¹¶å¡«å†™ä»£ç å“ˆå¸Œ
- [ ] æ·»åŠ  doc_referencesï¼ˆä¾èµ–å’Œå®ç°å…³ç³»ï¼‰
- [ ] è¡¥å…… ai_metadataï¼ˆdomain, key_concepts, entry_pointsï¼‰
- [ ] åˆå§‹åŒ– change_tracking
- [ ] è¿è¡ŒéªŒè¯å·¥å…· (npm run validate-meta)
- [ ] ä¿®å¤æ‰€æœ‰éªŒè¯é”™è¯¯
- [ ] æäº¤å˜æ›´ (git commit)
```

---

## ğŸ¯ è¿ç§»åçš„å¥½å¤„

å®Œæˆè¿ç§»åï¼Œä½ å°†è·å¾—ï¼š

1. **âœ… ç²¾ç¡®çš„ä»£ç å®šä½** - AI å·¥å…·èƒ½å¿«é€Ÿæ‰¾åˆ°ç›¸å…³ä»£ç 
2. **âœ… è‡ªåŠ¨å˜æ›´æ£€æµ‹** - ä»£ç ä¿®æ”¹åè‡ªåŠ¨æç¤ºæ›´æ–°æ–‡æ¡£
3. **âœ… é“¾æ¥æ°¸ä¸å¤±æ•ˆ** - æ–‡æ¡£ç§»åŠ¨è‡ªåŠ¨æ›´æ–°å¼•ç”¨
4. **âœ… çŸ¥è¯†å›¾è°±å¯è§†åŒ–** - ä¸€ç›®äº†ç„¶çš„ä¾èµ–å…³ç³»
5. **âœ… AI ç†è§£å¢å¼º** - æä¾›ä¸°å¯Œçš„ä¸Šä¸‹æ–‡ä¿¡æ¯

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ä¼˜å…ˆè¿ç§»æ ¸å¿ƒæ¨¡å—** - 20% çš„æ ¸å¿ƒä»£ç æä¾› 80% çš„ä»·å€¼
2. **ä¿æŒå“ˆå¸Œæ›´æ–°** - æ¯æ¬¡ä»£ç ä¿®æ”¹åè¿è¡Œ `update-hashes.js`
3. **å»ºç«‹åŒå‘å¼•ç”¨** - é‡è¦ä¾èµ–å…³ç³»è®¾ç½® `bidirectional: true`
4. **å®šæœŸéªŒè¯** - æ¯å‘¨è¿è¡Œ `npm run validate-meta`
5. **æ¸è¿›å¼å®Œå–„** - å…ˆå®ŒæˆåŸºç¡€å­—æ®µï¼Œå†é€æ­¥æ·»åŠ è¯¦ç»†ä¿¡æ¯

---

## ğŸ†˜ è·å–å¸®åŠ©

é‡åˆ°é—®é¢˜ï¼Ÿ

1. æŸ¥çœ‹ç¤ºä¾‹ï¼š`å¼€å‘æ–‡æ¡£/01_features/F001_csv_parsing/meta.json`
2. é˜…è¯» Schema å®šä¹‰ï¼š`tools/schemas/meta-schema.json`
3. è¿è¡ŒéªŒè¯å·¥å…·ï¼š`npm run validate-meta`
4. æŸ¥çœ‹éªŒè¯è¾“å‡ºçš„è¯¦ç»†é”™è¯¯ä¿¡æ¯

---

**æœ€åæ›´æ–°**: 2025-12-23
**ç‰ˆæœ¬**: v1.0.0
