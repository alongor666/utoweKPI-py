{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "https://autowrkpi.com/schemas/meta.json",
  "title": "åŠŸèƒ½æ¨¡å—å…ƒæ•°æ® Schema",
  "description": "å®šä¹‰åŠŸèƒ½æ¨¡å—å…ƒæ•°æ®çš„ç»“æ„ï¼Œæ”¯æŒä»£ç -æ–‡æ¡£åŒå‘é“¾æ¥å’Œ AI ç†è§£",
  "type": "object",
  "required": ["id", "name", "status"],
  "properties": {
    "id": {
      "type": "string",
      "pattern": "^F\\d{3}$",
      "description": "åŠŸèƒ½æ¨¡å—å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œæ ¼å¼: F001, F002...",
      "examples": ["F001", "F002", "F010"]
    },
    "name": {
      "type": "string",
      "minLength": 3,
      "maxLength": 100,
      "description": "åŠŸèƒ½æ¨¡å—åç§°",
      "examples": ["å¤šæºæ•°æ®æ‘„å…¥ä¸è§£æ", "KPIè®¡ç®—å¼•æ“"]
    },
    "status": {
      "type": "string",
      "enum": ["planned", "in_progress", "implemented", "deprecated", "fully_implemented"],
      "description": "åŠŸèƒ½çŠ¶æ€",
      "default": "planned"
    },
    "description": {
      "type": "string",
      "maxLength": 500,
      "description": "åŠŸèƒ½ç®€è¦æè¿°ï¼ˆ1-2 å¥è¯ï¼‰"
    },
    "core_files": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "æ ¸å¿ƒæ–‡ä»¶è·¯å¾„åˆ—è¡¨ï¼ˆåŸæœ‰å­—æ®µï¼Œä¿æŒå…¼å®¹æ€§ï¼‰",
      "examples": [["js/data.worker.js", "js/dashboard.js"]]
    },
    "tags": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "æ ‡ç­¾åˆ—è¡¨ï¼ˆåŸæœ‰å­—æ®µï¼Œä¿æŒå…¼å®¹æ€§ï¼‰",
      "examples": [["æ•°æ®å¤„ç†", "CSVè§£æ", "æ€§èƒ½ä¼˜åŒ–"]]
    },
    "updated_at": {
      "type": "string",
      "format": "date",
      "description": "æœ€åæ›´æ–°æ—¥æœŸï¼ˆåŸæœ‰å­—æ®µï¼‰",
      "examples": ["2025-12-23"]
    },
    "dependencies": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "ä¾èµ–çš„å…¶ä»–åŠŸèƒ½æ¨¡å— ID åˆ—è¡¨ï¼ˆåŸæœ‰å­—æ®µï¼‰",
      "examples": [["F001", "F002"]]
    },
    "related_decisions": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "description": "ç›¸å…³æŠ€æœ¯å†³ç­–æ–‡æ¡£ï¼ˆåŸæœ‰å­—æ®µï¼‰",
      "examples": [["D001_ECharts-CDNåŠ è½½ä¼˜åŒ–.md"]]
    },
    "code_references": {
      "type": "array",
      "description": "ğŸ†• ä»£ç å¼•ç”¨åˆ—è¡¨ - ç²¾ç¡®å®šä½åˆ°è¡Œå·",
      "items": {
        "$ref": "#/definitions/CodeReference"
      }
    },
    "doc_references": {
      "type": "array",
      "description": "ğŸ†• æ–‡æ¡£äº¤å‰å¼•ç”¨åˆ—è¡¨",
      "items": {
        "$ref": "#/definitions/DocReference"
      }
    },
    "ai_metadata": {
      "type": "object",
      "description": "ğŸ†• AI ç†è§£å…ƒæ•°æ®",
      "$ref": "#/definitions/AIMetadata"
    },
    "change_tracking": {
      "type": "object",
      "description": "ğŸ†• å˜æ›´è¿½è¸ªä¿¡æ¯",
      "$ref": "#/definitions/ChangeTracking"
    }
  },
  "definitions": {
    "CodeReference": {
      "type": "object",
      "required": ["file", "label"],
      "properties": {
        "file": {
          "type": "string",
          "description": "ä»£ç æ–‡ä»¶è·¯å¾„ï¼ˆç›¸å¯¹äºé¡¹ç›®æ ¹ç›®å½•ï¼‰",
          "examples": ["js/data.worker.js", "css/dashboard.css"]
        },
        "lines": {
          "type": "string",
          "pattern": "^\\d+(-\\d+)?$",
          "description": "ä»£ç è¡Œå·èŒƒå›´ï¼Œæ ¼å¼: '145' æˆ– '145-230'",
          "examples": ["145-230", "42", "100-150"]
        },
        "label": {
          "type": "string",
          "description": "ä»£ç å—çš„è¯­ä¹‰æ ‡ç­¾",
          "examples": ["CSVè§£æä¸»é€»è¾‘", "KPIè®¡ç®—å¼•æ“", "ç­›é€‰å™¨çŠ¶æ€ç®¡ç†"]
        },
        "hash": {
          "type": "string",
          "pattern": "^[a-f0-9]{8}$",
          "description": "ä»£ç å—å†…å®¹çš„ SHA-256 å“ˆå¸Œï¼ˆå‰ 8 ä½ï¼‰ï¼Œç”¨äºæ£€æµ‹å˜æ›´",
          "examples": ["a3f5d2c1", "7b2e9f4a"]
        },
        "last_verified": {
          "type": "string",
          "format": "date",
          "description": "æœ€åéªŒè¯æ—¥æœŸ",
          "examples": ["2025-12-23"]
        },
        "critical": {
          "type": "boolean",
          "description": "æ˜¯å¦ä¸ºå…³é”®ä»£ç ï¼ˆå˜æ›´æ—¶å¼ºåˆ¶æ›´æ–°æ–‡æ¡£ï¼‰",
          "default": false
        }
      }
    },
    "DocReference": {
      "type": "object",
      "required": ["type", "doc_id"],
      "properties": {
        "type": {
          "type": "string",
          "enum": ["depends_on", "implements", "references", "extends", "conflicts_with", "replaces"],
          "description": "æ–‡æ¡£å…³ç³»ç±»å‹"
        },
        "doc_id": {
          "type": "string",
          "description": "ç›®æ ‡æ–‡æ¡£ IDï¼ˆåŠŸèƒ½ ID æˆ–å†³ç­– IDï¼‰",
          "examples": ["F002", "D001", "M001"]
        },
        "reason": {
          "type": "string",
          "maxLength": 200,
          "description": "å…³ç³»è¯´æ˜",
          "examples": ["ä¸šåŠ¡ç±»å‹æ˜ å°„ä¾èµ–", "å®ç°äº†æ­¤å†³ç­–"]
        },
        "bidirectional": {
          "type": "boolean",
          "description": "æ˜¯å¦ä¸ºåŒå‘å…³ç³»ï¼ˆéœ€è¦åœ¨ç›®æ ‡æ–‡æ¡£ä¸­ä¹Ÿå»ºç«‹åå‘å¼•ç”¨ï¼‰",
          "default": false
        },
        "strength": {
          "type": "string",
          "enum": ["weak", "medium", "strong"],
          "description": "ä¾èµ–å¼ºåº¦",
          "default": "medium"
        }
      }
    },
    "AIMetadata": {
      "type": "object",
      "description": "å¸®åŠ© AI å·¥å…·ç†è§£ä»£ç çš„å…ƒæ•°æ®",
      "properties": {
        "domain": {
          "type": "string",
          "description": "æ‰€å±ä¸šåŠ¡åŸŸ",
          "examples": ["æ•°æ®å¤„ç†", "UIäº¤äº’", "æ€§èƒ½ä¼˜åŒ–", "ä¸šåŠ¡é€»è¾‘"]
        },
        "complexity": {
          "type": "string",
          "enum": ["low", "medium", "high", "very_high"],
          "description": "å¤æ‚åº¦ç­‰çº§",
          "default": "medium"
        },
        "key_concepts": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "å…³é”®æ¦‚å¿µåˆ—è¡¨ï¼ˆå¸®åŠ© AI ç†è§£ä¸Šä¸‹æ–‡ï¼‰",
          "examples": [["Web Worker", "å¼‚æ­¥å¤„ç†", "å¤§æ–‡ä»¶å¤„ç†"]]
        },
        "entry_points": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "ä¸»è¦å…¥å£å‡½æ•°/ç±»å",
          "examples": [["processData", "Dashboard", "calculateKPI"]]
        },
        "output_contracts": {
          "type": "object",
          "description": "å‡½æ•°è¾“å‡ºå¥‘çº¦ï¼ˆå¸®åŠ© AI ç†è§£æ•°æ®æµï¼‰",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "returns": {
                "type": "string",
                "description": "è¿”å›å€¼ç±»å‹"
              },
              "description": {
                "type": "string",
                "description": "è¿”å›å€¼è¯´æ˜"
              }
            }
          }
        },
        "common_issues": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "å¸¸è§é—®é¢˜å’Œæ³¨æ„äº‹é¡¹",
          "examples": [["éœ€è¦æ£€æŸ¥ Worker ç›‘å¬å™¨æ˜¯å¦æ­£ç¡®ç§»é™¤", "å¤§æ–‡ä»¶å¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡º"]]
        }
      }
    },
    "ChangeTracking": {
      "type": "object",
      "description": "å˜æ›´è¿½è¸ªä¿¡æ¯",
      "properties": {
        "last_code_change": {
          "type": "string",
          "format": "date",
          "description": "æœ€åä»£ç å˜æ›´æ—¥æœŸ"
        },
        "last_doc_sync": {
          "type": "string",
          "format": "date",
          "description": "æœ€åæ–‡æ¡£åŒæ­¥æ—¥æœŸ"
        },
        "sync_status": {
          "type": "string",
          "enum": ["synced", "needs_update", "diverged", "unknown"],
          "description": "åŒæ­¥çŠ¶æ€",
          "default": "unknown"
        },
        "pending_updates": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "description": "å¾…æ›´æ–°å†…å®¹åˆ—è¡¨",
          "examples": [["æ›´æ–° parseCSV å‡½æ•°è¯´æ˜", "æ·»åŠ æ–°å¢å‚æ•°æ–‡æ¡£"]]
        },
        "auto_sync_enabled": {
          "type": "boolean",
          "description": "æ˜¯å¦å¯ç”¨è‡ªåŠ¨åŒæ­¥",
          "default": true
        }
      }
    }
  }
}
